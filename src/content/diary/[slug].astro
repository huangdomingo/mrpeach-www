---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection, getEntry } from 'astro:content';
import type { APIContext } from 'astro';

export async function getStaticPaths() {
  const posts = await getCollection('diary');
  return posts.map((post) => ({
    params: { slug: post.slug },
  }));
}

interface Props {
  post: Awaited<ReturnType<typeof getEntry<'diary'>>>;
}

export async function GET(context: APIContext) {
  // 這裡不需要，主要用 getStaticPaths + 頁面本身
}

const { slug } = Astro.params;
const post = await getEntry('diary', slug as string);
---

<BaseLayout title={`${post.data.title}｜產地日記`}>
  <article class="max-w-3xl mx-auto px-4 py-10">
    <h1 class="text-3xl font-bold mb-2">{post.data.title}</h1>
    <p class="text-sm text-slate-500 mb-6">{post.data.date}</p>
    <post.render.Content />
  </article>
</BaseLayout>
